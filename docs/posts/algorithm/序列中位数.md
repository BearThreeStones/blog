â€‹æœ€è¿‘æ‰¾å®ä¹ è¢«ç‹ ç‹ ç¬”è¯•æ‹·æ‰“äº†ğŸ˜­ï¼Œç°åœ¨çœ‹æ¥è¿˜æ˜¯åŸºç¡€ä¸æ‰å®ï¼Œé¢˜æ˜¯å†™äº†ï¼Œä½†æ˜¯æ²¡æœ‰å¤ç›˜æ€»ç»“ï¼Œä¸ä¹…å°±å¿˜äº†ï¼Œæˆ‘å†³å®šå¼€ä¸€ä¸ªæ–°çš„å°ä¸“æ æ¥è®°å½•å’Œåˆ†ææˆ‘å†™è¿‡çš„ç®—æ³•é¢˜ã€‚å…ˆä»è…¾è®¯ 23 å¹´ç§‹æ‹›çš„ä¸€é“é¢˜ç›®å¼€å§‹å§ï¼[é“¾æ¥åœ¨è¿™é‡Œ](https://kamacoder.com/problempage.php?pid=1232)ã€‘

å…ˆæ¥çœ‹çœ‹é¢˜ç›®ï¼š

# é¢˜ç›®æè¿°

ç‰›ç‰›æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°åºåˆ— aï¼Œä»¥åŠä¸€ä¸ªé•¿åº¦ä¸º n - 1 çš„æ•´æ•°åºåˆ— bï¼Œå…¶ä¸­ b ä¸­çš„å…ƒç´ å„ä¸ç›¸åŒã€‚ç‰›ç‰›ä¼šé¦–å…ˆè®¡ç®—åºåˆ— a çš„ä¸­ä½æ•°ï¼Œç„¶åæŒ‰ç…§åºåˆ— b çš„é¡ºåºï¼Œä¾æ¬¡åˆ é™¤åŸåºåˆ— aÂ ä¸­å¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå³åˆ é™¤ a[b[i]]ï¼Œå…¶ä¸­ 0 <= i < n - 1ã€‚æ¯æ¬¡åˆ é™¤åï¼Œç‰›ç‰›ä¼šé‡æ–°è®¡ç®—åºåˆ— a ä¸­å‰©ä½™å…ƒç´ çš„ä¸­ä½æ•°ã€‚

è‹¥å‰©ä½™å…ƒç´ æ•°é‡ä¸ºå¥‡æ•°ï¼Œåˆ™ä¸­ä½æ•°ä¸ºæ’åºåä¸­é—´çš„é‚£ä¸ªæ•°ã€‚

è‹¥å‰©ä½™å…ƒç´ æ•°é‡ä¸ºå¶æ•°ï¼Œåˆ™ä¸­ä½æ•°ä¸ºæ’åºåä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚

ç‰›ç‰›å°†æ¯æ¬¡è®¡ç®—å¾—åˆ°çš„ä¸­ä½æ•°è®°å½•ä¸‹æ¥ï¼Œä½†æ‹…å¿ƒå‡ºç°é”™è¯¯ã€‚è¯·ä½ å¸®åŠ©ä»–éªŒè¯ç»“æœæ˜¯å¦æ­£ç¡®ã€‚

## è¾“å…¥æè¿°

ç¬¬ä¸€è¡Œè¾“å…¥ä¸€ä¸ªæ•´æ•° tï¼ˆ1 <= t <= 10ï¼‰ï¼Œè¡¨ç¤ºæ•°æ®ç»„çš„æ•°é‡ã€‚å¯¹äºæ¯ç»„æ•°æ®ï¼Œè¾“å…¥ä¸‰è¡Œï¼š

ç¬¬ä¸€è¡Œä¸ºä¸€ä¸ªæ•´æ•° nï¼ˆ1 <= n <= 10000ï¼‰ï¼Œè¡¨ç¤ºåºåˆ—çš„é•¿åº¦ã€‚

ç¬¬äºŒè¡Œä¸º n ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåºåˆ— a çš„å…ƒç´ ï¼ˆ1 <= a[i] <= 10^9ï¼‰ã€‚

ç¬¬ä¸‰è¡Œä¸º n - 1 ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåºåˆ— b çš„å…ƒç´ ï¼ˆ1 <= b[i] < nï¼‰ã€‚

## è¾“å‡ºæè¿°

å¯¹äºæ¯ç»„æ•°æ®ï¼Œè¾“å‡ºä¸€è¡Œï¼ŒåŒ…å« n ä¸ªæ•°ï¼Œè¡¨ç¤ºæ¯æ¬¡åˆ é™¤åçš„ä¸­ä½æ•°ç»“æœã€‚

å¦‚æœä¸­ä½æ•°æ˜¯æµ®ç‚¹æ•°ï¼Œåˆ™ä¿ç•™ä¸€ä½å°æ•°ã€‚

å¦‚æœä¸­ä½æ•°æ˜¯æ•´æ•°ï¼Œåˆ™ç›´æ¥è¾“å‡ºæ•´æ•°ã€‚

# æ–¹æ³•ä¸€ï¼šç›´æ¥åˆ é™¤

è§£é¢˜æ€è·¯

å””ï¼Œåˆšå¼€å§‹çœ‹åˆ°è¿™é“é¢˜ç›®å¾ˆå®¹æ˜“æƒ³åˆ°ç›´æ¥åˆ é™¤æ•°ç»„å…ƒç´ ï¼Œä½†è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æœ‰ç‚¹é«˜ï¼Œä»£ç å¦‚ä¸‹ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;
#define endl '\n'

// è®¡ç®—å¹¶è¿”å›ä¸­ä½æ•°
double findMedian(vector<int>& nums) {
    int n = nums.size();
    if (n % 2 == 1) {
        return nums[n / 2]; // å¥‡æ•°é•¿åº¦ï¼Œè¿”å›ä¸­é—´çš„å…ƒç´ 
    } else {
        // å¶æ•°é•¿åº¦ï¼Œè¿”å›ä¸­é—´ä¸¤ä¸ªå…ƒç´ çš„å¹³å‡å€¼
        return (nums[n / 2] + nums[n / 2 - 1]) / 2.0;
    }
}

int main(){
    int t;
    cin >> t;
    while(t--){
        int n;
        cin>> n;
        vector<int> a(n);
        vector<int> b(n - 1);
        
        for(int i = 0; i < n; i++){
            cin >> a[i];
        }
        
        for(int i = 0; i < n - 1; i++){
            cin >> b[i];
        }
        
        vector<int> nums = a;
        vector<double> answers;
        sort(nums.begin(), nums.end());
        
        // æŠŠä¸­ä½æ•°æ”¾è¿›ç»“æœé›†
        answers.push_back(findMedian(nums));
        
        for(int i = 0; i < n - 1; i++){
            int target = a[b[i]];
            // åˆ é™¤ç›®æ ‡å€¼
            nums.erase(find(nums.begin(), nums.end(), target));
            // æŠŠä¸­ä½æ•°æ”¾è¿›ç»“æœé›†
            answers.push_back(findMedian(nums));
        }
        
        for(auto answer : answers){
            // åˆ¤æ–­æ˜¯å¦æ˜¯æ•´æ•°
            if(answer == (int)answer)
                printf("%d ", (int)answer);
            else
                printf("%.1f ", answer);
        }
        cout << endl;
    }
}
```

å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼šå› ä¸ºç§»é™¤æ•°ç»„ä¸­å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œæ•…æ€»æ—¶é—´å¤æ‚åº¦ä¸ºÂ O(t * n^2) å‹‰å¼ºé€šè¿‡

ç©ºé—´å¤æ‚åº¦ï¼šå› ä¸ºä½¿ç”¨äº†æ•°ç»„ï¼ŒO(n)

# æ–¹æ³•äºŒï¼šmultiset æ¨¡æ‹Ÿ

è§£é¢˜æ€è·¯

ä½¿ç”¨ä¸¤ä¸ª multiset åˆ†åˆ«ä¿å­˜æ’åºåçš„æ•°ç»„å¹³åˆ†åçš„å·¦å³éƒ¨åˆ†ï¼Œå½“å‰©ä½™çš„æ•°å­—ä¸ºå¥‡æ•°æ—¶ä¿è¯å³æ•°ç»„çš„å¤§å°æ¯”å·¦æ•°ç»„å¤§1ï¼Œè‹¥ä¸ºå¶æ•°ä¿è¯å·¦å³æ•°ç»„çš„å¤§å°ç›¸ç­‰ã€‚

åœ¨å†³å®šç§»é™¤å·¦æ•°ç»„è¿˜æ˜¯å³æ•°ç»„ä¸­çš„å…ƒç´ æ—¶ï¼Œå¯ä»¥å‚è€ƒå‰ä¸€æ¬¡çš„ä¸­ä½æ•°ï¼Œè‹¥è¦ç§»é™¤çš„æ•°æ¯”å‰ä¸€æ¬¡çš„ä¸­ä½æ•°å¤§ï¼Œè¯´æ˜è¦ç§»é™¤çš„æ•°åœ¨å³æ•°ç»„ä¸­ï¼Œåˆ™ç§»é™¤å³æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œåä¹‹ç§»é™¤å·¦æ•°ç»„çš„å…ƒç´ ã€‚

å¦‚æœå‰ä¸€æ¬¡çš„ä¸­ä½æ•°å’Œç°åœ¨è¦ç§»é™¤çš„æ•°ç›¸ç­‰ï¼Œè¿˜æ˜¯ç§»é™¤å³æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥ç€æ¥åˆ†æï¼š

å¦‚æœå‰ä¸€æ¬¡çš„ç§»é™¤å…ƒç´ å®Œæˆåçš„æ•°ç»„ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æˆ‘ä»¬ç°åœ¨è¦ç§»é™¤çš„å…ƒç´ äº†ï¼Œä¹Ÿå¯èƒ½æœ‰å¤šä¸ªä¸ç°åœ¨è¦ç§»é™¤çš„å…ƒç´ ç›¸ç­‰çš„å…ƒç´ ï¼Œä½†æ˜¯æˆ‘ä»¬ä¿è¯å³æ•°ç»„çš„å¤§å°å§‹ç»ˆå¤§äºå·¦æ•°ç»„çš„å¤§å°ï¼Œæ‰€ä»¥ä¸€å®šä¼šæœ‰è‡³å°‘ä¸€ä¸ªè¦ç§»é™¤çš„å…ƒç´ åœ¨å³æ•°ç»„å†…ï¼Œä¹Ÿå°±æ˜¯ç§»é™¤å³æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¯è¡Œçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

ï¿¼â€‹

ï¿¼ç¼–è¾‘

å¦‚æœå‰ä¸€æ¬¡ç§»é™¤å®Œæˆåçš„æ•°ç»„ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆå‰ä¸€æ¬¡ç§»é™¤å®Œæˆåçš„æ•°ç»„ä¸­ä¸€å®šè‡³å°‘æœ‰ä¸€ä¸ªç°åœ¨è¦ç§»é™¤çš„å…ƒç´ ã€‚ä¸ºä»€ä¹ˆä¸ä¼šæ˜¯ä¸¤ä¸ªåŠ èµ·æ¥å’Œä¸ºç°åœ¨è¦ç§»é™¤çš„å…ƒç´ çš„å¤§å°ä¸¤å€çš„å…ƒç´ å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¾—åˆ°çš„æ˜¯æ’åºåçš„æ•°ç»„ï¼Œè€Œä¸”ç°åœ¨è¦ç§»é™¤çš„å…ƒç´ ä¸€å®šåœ¨æ•°ç»„å†…ï¼Œæ‰€ä»¥ä¸å¯èƒ½å‡ºç°æ¯”è¦ç§»é™¤çš„å…ƒç´ å¤§å’Œå°çš„å…ƒç´ ç´§æŒ¨ç€çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦å‡ºç°å‰ä¸€æ¬¡ç§»é™¤å®Œæˆåçš„æ•°ç»„ä¸ºå¶æ•°ï¼Œä¸”ä¸­ä½æ•°ä¸ç°åœ¨è¦ç§»é™¤çš„å…ƒç´ ç›¸ç­‰çš„æƒ…å†µï¼Œé‚£ä¹ˆä¸€å®šè‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ çš„å¤§å°å’Œç°åœ¨è¦ç§»é™¤çš„å…ƒç´ å¤§å°ç›¸ç­‰ã€‚æ‰€ä»¥è¿˜æ˜¯ä¸€å®šä¼šæœ‰è‡³å°‘ä¸€ä¸ªè¦ç§»é™¤çš„å…ƒç´ åœ¨å³æ•°ç»„å†…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

ï¿¼â€‹

ï¿¼ç¼–è¾‘

æ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœå‰ä¸€æ¬¡çš„ä¸­ä½æ•°å’Œç°åœ¨è¦ç§»é™¤çš„æ•°ç›¸ç­‰ï¼Œè¿˜æ˜¯ç§»é™¤å³æ•°ç»„ä¸­çš„å…ƒç´ ã€‚

æ³¨æ„è¦ä½¿ç”¨è¿­ä»£å™¨ç§»é™¤å…ƒç´ ï¼Œè¿™æ ·ä¸ä¼šå°†æ‰€æœ‰ç›¸åŒçš„å…ƒç´ ç§»é™¤ã€‚ä»£ç å¦‚ä¸‹ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;
#define endl '\n'

// ä½¿ç”¨ä¸¤ä¸ªmultisetåˆ†åˆ«ç»´æŠ¤æ•°ç»„çš„å·¦å³ä¸¤éƒ¨åˆ†ï¼š
// leftNumsï¼šé™åºæ’åˆ—ï¼Œå­˜å‚¨è¾ƒå°çš„ä¸€åŠå…ƒç´ ï¼ˆå¯å¿«é€Ÿè·å–æœ€å¤§å€¼ï¼‰
// rightNumsï¼šå‡åºæ’åˆ—ï¼Œå­˜å‚¨è¾ƒå¤§çš„ä¸€åŠå…ƒç´ ï¼ˆå¯å¿«é€Ÿè·å–æœ€å°å€¼ï¼‰
multiset<int, greater<int>> leftNums;
multiset<int> rightNums;

// è®¡ç®—å½“å‰ä¸­ä½æ•°
double findMedian() {
    double result = 0;
    // å½“å…ƒç´ æ€»æ•°ä¸ºå¥‡æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸ºå…ƒç´ è¾ƒå¤šçš„é›†åˆçš„é¦–å…ƒç´ 
    if (leftNums.size() != rightNums.size()) {
        if (rightNums.size() > leftNums.size()) {
            result = *rightNums.begin(); // å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
        } else {
            result = *leftNums.begin(); // å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
        }
    }
    // å½“å…ƒç´ æ€»æ•°ä¸ºå¶æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸ºä¸¤ä¸ªé›†åˆé¦–å…ƒç´ çš„å¹³å‡å€¼
    else {
        result = *leftNums.begin() + (*rightNums.begin() - *leftNums.begin()) / 2.0;
    }
    return result;
}

int main() {
    int t;
    cin >> t;
    while (t--) {
        leftNums.clear();
        rightNums.clear();
        int n;
        cin >> n;
        vector<int> a(n);
        vector<int> b(n - 1);
        
        // è¯»å–åˆå§‹æ•°ç»„
        for (int i = 0; i < n; i++) {
            cin >> a[i];
        }
        
        // è¯»å–åˆ é™¤é¡ºåºæ•°ç»„ï¼ˆä¿å­˜è¦åˆ é™¤çš„ç´¢å¼•ï¼‰
        for (int i = 0; i < n - 1; i++) {
            cin >> b[i];
        }
        
        vector<int> nums(a); // åˆ›å»ºå¯ä¿®æ”¹çš„æ•°ç»„å‰¯æœ¬
        vector<double> answers; // ä¿å­˜æ¯ä¸ªæ­¥éª¤çš„ä¸­ä½æ•°ç»“æœ
        
        // åˆå§‹æ’åºä»¥åˆ†å‰²å·¦å³éƒ¨åˆ†
        sort(nums.begin(), nums.end());
        
        // å°†æ’åºåçš„æ•°ç»„å‡åˆ†åˆ°å·¦å³é›†åˆ
        for (int i = 0; i < nums.size() / 2; i++) {
            leftNums.insert(nums[i]); // è¾ƒå°çš„ä¸€åŠå­˜å…¥å·¦é›†åˆ
        }
        for (int i = nums.size() / 2; i < nums.size(); i++) {
            rightNums.insert(nums[i]); // è¾ƒå¤§çš„ä¸€åŠå­˜å…¥å³é›†åˆ
        }
        
        // è®°å½•åˆå§‹ä¸­ä½æ•°
        answers.push_back(findMedian());
        
        // å¤„ç†æ¯ä¸ªåˆ é™¤æ“ä½œ
        for (int i = 0; i < n - 1; i++) {
            // æ ¹æ®å½“å‰ä¸­ä½æ•°åˆ¤æ–­è¢«åˆ é™¤å…ƒç´ å±äºå“ªä¸ªé›†åˆ
            if (answers[i] > a[b[i]]) {
                // å½“å…ƒç´ å°äºä¸­ä½æ•°æ—¶ï¼Œåº”ä»å·¦é›†åˆåˆ é™¤
                auto it = leftNums.find(a[b[i]]);
                if (it != leftNums.end()) {
                    leftNums.erase(it);
                }
            } else {
                // å½“å…ƒç´ å¤§äºç­‰äºä¸­ä½æ•°æ—¶ï¼Œä»å³é›†åˆåˆ é™¤
                auto it = rightNums.find(a[b[i]]);
                if (it != rightNums.end()) {
                    rightNums.erase(it);
                }
            }
            
            int total = leftNums.size() + rightNums.size();
            
            // è°ƒæ•´å·¦å³é›†åˆçš„å¹³è¡¡ï¼Œç¡®ä¿å¤§å°å·®ä¸è¶…è¿‡1
            if (leftNums.size() > total / 2) {
                // å·¦é›†åˆå…ƒç´ è¿‡å¤šï¼Œç§»åŠ¨æœ€å¤§å€¼åˆ°å³é›†åˆ
                rightNums.insert(*leftNums.begin());
                leftNums.erase(leftNums.begin());
            }
            if (leftNums.size() < total / 2) {
                // å³é›†åˆå…ƒç´ è¿‡å¤šï¼Œç§»åŠ¨æœ€å°å€¼åˆ°å·¦é›†åˆ
                leftNums.insert(*rightNums.begin());
                rightNums.erase(rightNums.begin());
            }
            
            // è®¡ç®—æ–°çš„ä¸­ä½æ•°å¹¶è®°å½•
            answers.push_back(findMedian());
        }
        
        // æ ¼å¼åŒ–è¾“å‡ºç»“æœ
        for (auto answer : answers) {
            if (answer == (int)answer) {
                printf("%d ", (int)answer); // æ•´æ•°è¾“å‡º
            } else {
                printf("%.1f ", answer); // ä¿ç•™ä¸€ä½å°æ•°
            }
        }
        cout << endl;
    }
    return 0;
}
``` 

å½“ç„¶äº†ï¼Œå¦‚æœæˆ‘ä»¬å§‹ç»ˆä¿è¯å·¦æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡å§‹ç»ˆå¤§äºç­‰äºå³æ•°ç»„ä¸­çš„ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ç›¸ç­‰æ—¶å°±è¦ç§»é™¤å·¦æ•°ç»„ä¸­çš„å…ƒç´ äº†ã€‚

ä½†æ˜¯è¦æ³¨æ„ï¼šåˆå§‹åŒ–åˆ†å‰²æ•°ç»„æ—¶è¦å°†æ•°ç»„å¤§å°åŠ 1å†é™¤ä»¥2ï¼Œä¸ºäº†ä¿è¯å·¦æ•°ç»„çš„å¤§å°å¤§äºç­‰äºå³æ•°ç»„çš„å¤§å°ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;
#define endl '\n'

// ä½¿ç”¨ä¸¤ä¸ªmultisetç»´æŠ¤æœ‰åºæ•°ç»„çš„å·¦å³ä¸¤éƒ¨åˆ†
// leftNums: é™åºæ’åˆ—ï¼Œå­˜å‚¨è¾ƒå°çš„ä¸€åŠå…ƒç´ ï¼ˆå…è®¸å¿«é€Ÿè·å–æœ€å¤§å€¼ï¼‰
// rightNums: å‡åºæ’åˆ—ï¼Œå­˜å‚¨è¾ƒå¤§çš„ä¸€åŠå…ƒç´ ï¼ˆå…è®¸å¿«é€Ÿè·å–æœ€å°å€¼ï¼‰
multiset<int, greater<int>> leftNums;
multiset<int> rightNums;

// è®¡ç®—å½“å‰ä¸­ä½æ•°
double findMedian() {
    double result = 0;
    // å½“å…ƒç´ æ€»æ•°æ˜¯å¥‡æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸ºå…ƒç´ è¾ƒå¤šçš„é›†åˆçš„é¦–å…ƒç´ 
    if (leftNums.size() != rightNums.size()) {
        // é€šè¿‡æ¯”è¾ƒé›†åˆå¤§å°ç¡®å®šä¸­ä½æ•°ä½ç½®
        if (leftNums.size() > rightNums.size()) {
            result = *leftNums.begin(); // å·¦åŠéƒ¨åˆ†çš„æœ€å¤§å€¼
        } else {
            result = *rightNums.begin(); // å³åŠéƒ¨åˆ†çš„æœ€å°å€¼
        }
    }
    // å½“å…ƒç´ æ€»æ•°æ˜¯å¶æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸ºä¸¤é›†åˆé¦–å…ƒç´ çš„å¹³å‡å€¼
    else {
        result = *leftNums.begin() + (*rightNums.begin() - *leftNums.begin()) / 2.0;
    }
    return result;
}

int main() {
    int t;
    cin >> t;
    while (t--) {
        leftNums.clear();
        rightNums.clear();
        int n;
        cin >> n;
        vector<int> a(n);
        vector<int> b(n - 1);
        
        // è¯»å–åˆå§‹æ•°ç»„å…ƒç´ 
        for (int i = 0; i < n; i++) {
            cin >> a[i];
        }
        
        // è¯»å–åˆ é™¤é¡ºåºæ•°ç»„ï¼ˆæ³¨æ„å­˜å‚¨çš„æ˜¯ç´¢å¼•å€¼ï¼‰
        for (int i = 0; i < n - 1; i++) {
            cin >> b[i];
        }
        
        vector<int> nums(a); // åˆ›å»ºå¯ä¿®æ”¹çš„æ•°ç»„å‰¯æœ¬
        vector<double> answers; // å­˜å‚¨å„é˜¶æ®µçš„ä¸­ä½æ•°ç»“æœ
        
        // åˆå§‹æ’åºä»¥åˆ†å‰²å·¦å³éƒ¨åˆ†
        sort(nums.begin(), nums.end());
        
        /* å…³é”®ä¿®æ”¹ç‚¹1ï¼šåˆå§‹åŒ–åˆ†å‰²ç­–ç•¥æ”¹å˜ */
        // å°†æ•°ç»„åˆ†å‰²ä¸ºå·¦å¤§å³å°çš„ä¸¤éƒ¨åˆ†ï¼š
        // - å·¦åŠéƒ¨åˆ†åŒ…å«å‰ (n+1)/2 ä¸ªå…ƒç´ ï¼ˆå¥‡æ•°æ—¶å·¦åŠå¤š1ä¸ªå…ƒç´ ï¼‰
        // - ä¿è¯åˆå§‹ä¸­ä½æ•°å¯ä»¥ç›´æ¥ä»leftNumsè·å–
        for (int i = 0; i < (nums.size() + 1) / 2; i++) {
            leftNums.insert(nums[i]); // è¾ƒå°çš„ä¸€åŠå­˜å…¥å·¦é›†åˆ
        }
        for (int i = (nums.size() + 1) / 2; i < nums.size(); i++) {
            rightNums.insert(nums[i]); // è¾ƒå¤§çš„ä¸€åŠå­˜å…¥å³é›†åˆ
        }
        
        // è®°å½•åˆå§‹ä¸­ä½æ•°
        answers.push_back(findMedian());
        
        // å¤„ç†æ¯ä¸ªåˆ é™¤æ“ä½œ
        for (int i = 0; i < n - 1; i++) {
            /* å…³é”®ä¿®æ”¹ç‚¹2ï¼šåˆ é™¤æ¡ä»¶åˆ¤æ–­æ”¹å˜ï¼ˆ>= æ›¿ä»£ >ï¼‰*/
            // æ ¹æ®å½“å‰ä¸­ä½æ•°åˆ¤æ–­å…ƒç´ å½’å±é›†åˆï¼š
            // - å½“å…ƒç´ å€¼ <= å½“å‰ä¸­ä½æ•°æ—¶ï¼Œä»å·¦é›†åˆåˆ é™¤
            // - å½“å…ƒç´ å€¼ > å½“å‰ä¸­ä½æ•°æ—¶ï¼Œä»å³é›†åˆåˆ é™¤
            if (answers[i] >= a[b[i]]) {
                auto it = leftNums.find(a[b[i]]);
                if (it != leftNums.end()) {
                    leftNums.erase(it); // ä»å·¦é›†åˆå®‰å…¨åˆ é™¤
                }
            } else {
                auto it = rightNums.find(a[b[i]]);
                if (it != rightNums.end()) {
                    rightNums.erase(it); // ä»å³é›†åˆå®‰å…¨åˆ é™¤
                }
            }
            
            int total = leftNums.size() + rightNums.size();
            
            /* å…³é”®ä¿®æ”¹ç‚¹3ï¼šå¹³è¡¡é€»è¾‘æ”¹ä¸ºä¼˜å…ˆè°ƒæ•´å³é›†åˆ */
            // å†å¹³è¡¡ç­–ç•¥ï¼šç¡®ä¿ä¸¤é›†åˆå¤§å°å·®ä¸è¶…è¿‡1
            if (rightNums.size() > total / 2) {
                // å³é›†åˆå…ƒç´ è¿‡å¤šï¼Œç§»åŠ¨æœ€å°å€¼åˆ°å·¦é›†åˆ
                leftNums.insert(*rightNums.begin());
                rightNums.erase(rightNums.begin());
            }
            if (rightNums.size() < total / 2) {
                // å·¦é›†åˆå…ƒç´ è¿‡å¤šï¼Œç§»åŠ¨æœ€å¤§å€¼åˆ°å³é›†åˆ
                rightNums.insert(*leftNums.begin());
                leftNums.erase(leftNums.begin());
            }
            
            // è®¡ç®—å¹¶è®°å½•æ–°çš„ä¸­ä½æ•°
            answers.push_back(findMedian());
        }
        
        // æ ¼å¼åŒ–è¾“å‡ºç»“æœ
        for (auto answer : answers) {
            // æ ¹æ®æ˜¯å¦ä¸ºæ•´æ•°å†³å®šè¾“å‡ºæ ¼å¼
            if (answer == (int)answer)
                printf("%d ", (int)answer); // æ•´æ•°è¾“å‡º
            else
                printf("%.1f ", answer); // ä¿ç•™ä¸€ä½å°æ•°
        }
        cout << endl;
    }
    return 0;
}
```

å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼šæ¯ä¸ªæ’å…¥å’Œåˆ é™¤æ“ä½œåœ¨ multiset ä¸­ä¸ºO(log n)ï¼Œæ¯æ¬¡è°ƒæ•´æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸ºO( t * n log n)ã€‚

ç©ºé—´å¤æ‚åº¦ï¼šä½¿ç”¨ä¸¤ä¸ª multiset å­˜å‚¨å…ƒç´ ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚

â€‹